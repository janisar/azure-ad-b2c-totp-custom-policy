<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<TrustFrameworkPolicy xmlns="http://schemas.microsoft.com/online/cpim/schemas/2013/06" PolicySchemaVersion="0.3.0.0"
                      TenantId="yourtenant.onmicrosoft.com"
                      PolicyId="B2C_1A_Demo_PasswordReset_TOTP"
                      PublicPolicyUri="http://yourtenant.onmicrosoft.com/B2C_1A_Demo_PasswordReset_TOTP">

    <BasePolicy>
        <TenantId>yourtenant.onmicrosoft.com</TenantId>
        <PolicyId>B2C_1A_Demo_TrustFrameworkExtensions_TOTP</PolicyId>
    </BasePolicy>

    <RelyingParty>
        <DefaultUserJourney ReferenceId="PasswordResetWithTOTP"/>
        <TechnicalProfile Id="PolicyProfile">
            <DisplayName>PolicyProfile</DisplayName>
            <Protocol Name="OpenIdConnect"/>
            <OutputClaims>
                <OutputClaim ClaimTypeReferenceId="displayName"/>
                <OutputClaim ClaimTypeReferenceId="givenName"/>
                <OutputClaim ClaimTypeReferenceId="surname"/>
                <OutputClaim ClaimTypeReferenceId="email"/>
                <OutputClaim ClaimTypeReferenceId="extension_UserRoles"/>
                <OutputClaim ClaimTypeReferenceId="extension_UserType"/>
                <OutputClaim ClaimTypeReferenceId="extension_UserId"/>
                <OutputClaim ClaimTypeReferenceId="extension_UserVenues"/>
                <OutputClaim ClaimTypeReferenceId="objectId" PartnerClaimType="sub"/>
                <OutputClaim ClaimTypeReferenceId="tenantId" AlwaysUseDefaultValue="true"
                             DefaultValue="{Policy:TenantObjectId}"/>
            </OutputClaims>
            <SubjectNamingInfo ClaimType="sub"/>
        </TechnicalProfile>
    </RelyingParty>
</TrustFrameworkPolicy>